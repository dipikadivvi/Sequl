#1.Get all customers whose first name starts with 'J' and who are active.
select * from sakila.customer
where first_name like 'j%' and active ='1';
#(But I am getting null also. I don't know why)

#2.Find all films where the title contains the word 'ACTION' or the description contains 'WAR'.
select title,description from sakila.film
where title like '%ACTION%' or description like '%WAR%'

#3.List all customers whose last name is not 'SMITH' and whose first name ends with 'a'

select first_name,last_name from sakila.customer
where last_name not like 'SMITH' and first_name like '%a';

#4.Get all films where the rental rate is greater than 3.0 and the replacement cost is not null.
select * from sakila.film
where rental_rate > 3.0 and replacement_cost NOT LIKE 'NULL';
#(But I am still getting 1 NULL record at the end)

#5.Count how many customers exist in each store who have active status = 1
select count(*) AS customers from sakila.customer
where active = '1'
group by store_id

#6.Show distinct film ratings available in the film table.
select distinct(rating) from sakila.film

#7.Find the number of films for each rental duration where the average length is more than 100 minutes.
select count(title) AS numberoffilms,length,rental_duration from sakila.film 
group by rental_duration
having length > 100


#8.List payment dates and total amount paid per date, but only include days where more than 100 payments were made.
select  DATE(payment_date) AS payment_date_only, SUM(amount) as Total_paid from payment
group by Date(payment_date)
having sum(amount)>100


#9.Find customers whose email address is null or ends with '.org'.
select * from sakila.customer
where email like 'null' or '%.org'

#10.List all films with rating 'PG' or 'G', and order them by rental rate in descending order.
select * from sakila.film
where rating like 'PG' or 'G'
order by rental_rate DESC

#11.Count how many films exist for each length where the film title starts with 'T' and the count is more than 5.
select length,count(*) AS filmcount from film
where title like 'T%'
group by length
having count(*) >5

select length,count(title) AS film_Count from film
where title like 'T%'
group by length
having count(title) >5

#12.List all actors who have appeared in more than 10 films
select CONCAT(ac.first_name, ' ' ,ac.last_name) AS Customer_name, count(fa.film_id) AS film_count
FROM actor ac JOIN film_actor fa ON ac.actor_id = fa.actor_id
Group BY Customer_name
having film_count > 10
Order by film_count DESC;

#13.Find the top 5 films with the highest rental rates and longest lengths combined, ordering by rental rate first and length second.
SELECT * FROM SAKILA.FILM
ORDER BY rental_rate DESC, length DESC
LIMIT 5;

#14.Show all customers along with the total number of rentals they have made, ordered from most to least rentals.
select cu.customer_id,CONCAT(cu.first_name,' ',cu.last_name) AS customer_name,count(re.rental_id) AS rental_Count
FROM customer cu JOIN rental re ON cu.customer_id = re.customer_id
GROUP BY cu.customer_id,cu.first_name,cu.last_name
ORDER BY rental_Count DESC;


#15.List the film titles that have never been rented.
#15.List the film titles that have never been rented.
select title,rental_duration from film
where rental_duration LIKE 'NULL';

SELECT fi.title
FROM sakila.film fi
LEFT JOIN sakila.inventory iv ON fi.film_id = iv.film_id
LEFT JOIN sakila.rental re ON iv.inventory_id = re.inventory_id
WHERE re.rental_id IS NULL;

SELECT
    concat(c.first_name, " ", c.last_name) AS "Full_name", count(r.rental_id) as "Number of Rentals"
FROM
    customer c, rental r
WHERE 
    c.customer_id = r.customer_id
GROUP BY
    c.customer_id
HAVING count(r.rental_id) is NOT NULL;




