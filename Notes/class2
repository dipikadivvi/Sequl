#select 

 SELECT * FROM sakila.actor;
 -- to get the unique values we use DISTINCT
 SELECT DISTINCT first_name from sakila.actor;
 ----------
 -- gives data field which is null.
 select * from sakila.film where original_language_id is null;
 
 -- gives rows count. if first_names are 200 then count(*) also gives 200 like count(first_name)
 select count(first_name) from sakila.actor ;
  select count(title) from sakila.film ;
  
 select * from sakila.film;
 --------------
select distinct title,original_language_id from sakila.film where original_language_id is  null;

------------------------------------------------
select count(distinct(title)) from sakila.film;
-------------------------------
#count and distinct count 
-- difference is count of all rows and count of unique rows(for distinct)
select count(first_name) from sakila.actor;
select count(distinct(first_name)) from sakila.actor;
-------------------
#select specific columns 

SELECT first_name,last_name FROM sakila.actor;
-------------------------------
#Limit 
-- if you don't want to see all the rows then you can limit the view
SELECT first_name, last_name FROM sakila.actor limit 50;
--------------------
#filtering with where 

SELECT distinct(rating) FROM sakila.film;

SELECT * FROM sakila.film;

SELECT * FROM sakila.film WHERE rating = 'R'  and length >= 92;

SELECT * FROM sakila.film WHERE length >= 92;
------------------
#sorting  we have to use desc with orderby and not directly in select statement.
SELECT rental_rate from sakila.film;

SELECT  rental_rate FROM sakila.film ORDER BY rental_rate desc;

select * from sakila.film;
--------------------
#AND #OR operators 

SELECT * FROM sakila.film 
where rating = 'PG' and rental_duration = 5
ORDER BY rental_rate ASC;

SELECT * FROM sakila.film 
where rating = 'PG' or rental_duration = 5
ORDER BY rental_rate ASC;


--------------------------------------
#NOT 

SELECT * FROM sakila.film 
where rental_duration NOT IN ( 6, 7,3)
ORDER BY rental_rate ASC;

SELECT * FROM sakila.film 
where NOT rental_duration = 6 
ORDER BY rental_rate ASC;

SELECT * FROM sakila.film
where rental_duration != 6
ORDER BY rental_rate ASC;

SELECT * FROM sakila.film
where rental_duration NOT LIKE 6
ORDER BY rental_rate ASC;
-------------------------------------
SELECT * FROM sakila.film 
where rental_duration = 6 and (rating = 'G' OR rating = 'PG')
ORDER BY rental_rate ASC;


--------------------------------------------
#LIKE used with where clause 

-- There are two wildcards often used in conjunction with the LIKE operator:
-- 	The percent sign % represents zero, one, or multiple characters
-- 	The underscore sign _ represents one, single character
-- we use % for multiple characters... but _ refer to one. if we want 2 places then _ _.
SELECT city FROM sakila.city where city like 'A%S'; #' should start with A  and end with S'

SELECT city FROM sakila.city where city like '__a__%'; # ' any 2 digits then a and any 2 digits and anything afterthat'
-----------------------------------------------------------------------
#NULL Value

#Check Rentals That Were Never Returned 

select * from sakila.rental;

SELECT rental_id, inventory_id, customer_id, return_date
FROM sakila.rental
WHERE return_date  IS NULL;

-----------------------------------------
#between 

SELECT rental_id, inventory_id, customer_id, return_date
FROM sakila.rental
WHERE  return_date between '2005-05-26' and '2005-05-30';

------------------
#group by and having 
#TO CHECK DUPLICATES 

select  customer_id, COUNT(*) as count_rentals
FROM sakila.rental
GROUP BY customer_id
HAVING count(*) <= 30 
order by  count_rentals desc;

select count(*) from sakila.rental
group by customer_id
having count(*) <30;

-- select count(*) as count from sakila.rental;
-----------------------------------
#order of execution is SQL 

# from (table) ---> join ---> where --- group by --> having ---> select ---> order by  --> limit

----------------------
# DIFFERENCE BETWEEN where cluase and having 
-- order by count;PRIMARY
# where filters individual rows where having filters groups created by groupby function
# we can use any column from table, we must use columm present in groupby or aggregate functions
# cannot contain aggregate function , specially designed to filter based on aggregate functions
# execute first , execute after groupby
select * from sakila.rental where return_date is null;

select * from sakila.rental where customer_id = 33;
------------------------------
SELECT * FROM sakila.payment;

SELECT customer_id, sum(amount) as total_payment 
FROM sakila.payment
group by customer_id
having sum(amount) > 100 and customer_id between 1 and 100;
-----------------------------------------
